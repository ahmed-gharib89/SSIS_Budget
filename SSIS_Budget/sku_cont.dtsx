<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/20/2021 11:46:36 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="RIBO"
  DTS:CreatorName="RIBO\aghar"
  DTS:DTSID="{B8BE5689-49DF-49AC-A417-700BAD820A90}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.157"
  DTS:LocaleID="1033"
  DTS:ObjectName="Package1"
  DTS:PackageType="5"
  DTS:VersionBuild="14"
  DTS:VersionGUID="{C9050363-538D-4BE2-B56F-0B425DA8B597}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\INSERT INTO SKU_CONTRIBUTION_1"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="sku_cont_1"
      DTS:DTSID="{CC82C57E-4B8F-45CB-9C27-F8512B54072B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="INSERT INTO SKU_CONTRIBUTION_1"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="EXEC ('&#xA;INSERT into calc.SKU_CONTRIBUTION_1&#xA; SELECT&#xA;&#x9;   detailed.[Period_Year]&#xA;      , detailed.[Sales Group]&#xA;      , detailed.[Sales office]&#xA;&#x9;  , detailed.[Product] &#xA;&#x9;  ,price.PRICE_INCLUDE_TAX&#xA;&#x9;  ,price.PRICE as PRICE_EXCLUDE_TAX&#xA;&#x9;  ,sku.[RGB | NRB]&#xA;&#x9;  ,detailed.[SKU_Quantity]&#xA;&#x9;  /SUM(detailed.[SKU_Quantity]) &#xA;&#x9;  OVER ( PARTITION BY detailed.[Sales office], detailed.[Sales Group],sku.[RGB | NRB])&#xA;&#x9;  AS [SKU_contribution] &#xA;from  (SELECT&#xA;         [Period_Year]&#xA;&#x9;&#x9;, [Product]&#xA;&#x9;&#x9;, [Sales office]&#xA;&#x9;&#x9;, [Sales Group] &#xA;&#x9;&#x9;, SUM([Total Quantity]) AS [SKU_Quantity]&#xA;        FROM [bud].[bpre]&#xA;&#x9;&#x9;WHERE [BP|RE] = ''BP''&#xA;and [Period_Year] &gt;1&#xA;       GROUP BY &#xA;&#x9;&#x9;[Period_Year]&#xA;&#x9;&#x9;,[Product]&#xA;&#x9;&#x9;,[Sales office]&#xA;&#x9;&#x9;,[Sales Group]&#xA;&#x9;&#x9;) as detailed&#xA;join dim.DIM_SKU_PRICE as price&#xA;on price.SKU_CODE =detailed.Product&#xA;join dim.DIM_SKUS as sku&#xA;on sku.SKU_CODE = detailed.Product'&#xA;)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\INSERT INTO SKU_CONTRIBUTION_2"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="sku_cont_1"
      DTS:DTSID="{6643ba49-fe96-4223-97c8-4d4c896cb4fd}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="INSERT INTO SKU_CONTRIBUTION_2"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="EXEC ('&#xA;INSERT into calc.SKU_CONTRIBUTION_2&#xA; SELECT&#xA;    detailed.[Period_Year]&#xA;      , detailed.[Sales Group]&#xA;      , detailed.[Sales office]&#xA;   , detailed.[Product] &#xA;   ,price.PRICE_INCLUDE_TAX&#xA;   ,price.PRICE as PRICE_EXCLUDE_TAX&#xA;   ,sku.[RGB | NRB]&#xA;   ,detailed.[SKU_Quantity]&#xA;   /SUM(detailed.[SKU_Quantity]) &#xA;   OVER ( PARTITION BY detailed.[Sales office], detailed.[Sales Group],sku.[RGB | NRB])&#xA;   AS [SKU_contribution] &#xA;from  (SELECT&#xA;         [Period_Year]&#xA;  , [Product]&#xA;  , [Sales office]&#xA;  , [Sales Group] &#xA;  , SUM([Total Quantity]) AS [SKU_Quantity]&#xA;        FROM [bud].[bpre]&#xA;  WHERE [BP|RE] = ''BP''&#xA;and [Period_Year] &gt;2&#xA;       GROUP BY &#xA;  [Period_Year]&#xA;  ,[Product]&#xA;  ,[Sales office]&#xA;  ,[Sales Group]&#xA;  ) as detailed&#xA;join dim.DIM_SKU_PRICE as price&#xA;on price.SKU_CODE =detailed.Product&#xA;join dim.DIM_SKUS as sku&#xA;on sku.SKU_CODE = detailed.Product'&#xA;)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\INSERT INTO SKU_CONTRIBUTION_3"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="sku_cont_1"
      DTS:DTSID="{946a0e57-4422-4f3d-9323-0720062f5ab0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="INSERT INTO SKU_CONTRIBUTION_3"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="EXEC ('&#xA;INSERT into calc.SKU_CONTRIBUTION_3&#xA; SELECT&#xA;    detailed.[Period_Year]&#xA;      , detailed.[Sales Group]&#xA;      , detailed.[Sales office]&#xA;   , detailed.[Product] &#xA;   ,price.PRICE_INCLUDE_TAX&#xA;   ,price.PRICE as PRICE_EXCLUDE_TAX&#xA;   ,sku.[RGB | NRB]&#xA;   ,detailed.[SKU_Quantity]&#xA;   /SUM(detailed.[SKU_Quantity]) &#xA;   OVER ( PARTITION BY detailed.[Sales office], detailed.[Sales Group],sku.[RGB | NRB])&#xA;   AS [SKU_contribution] &#xA;from  (SELECT&#xA;         [Period_Year]&#xA;  , [Product]&#xA;  , [Sales office]&#xA;  , [Sales Group] &#xA;  , SUM([Total Quantity]) AS [SKU_Quantity]&#xA;        FROM [bud].[bpre]&#xA;  WHERE [BP|RE] = ''BP''&#xA;and [Period_Year] &gt;3&#xA;       GROUP BY &#xA;  [Period_Year]&#xA;  ,[Product]&#xA;  ,[Sales office]&#xA;  ,[Sales Group]&#xA;  ) as detailed&#xA;join dim.DIM_SKU_PRICE as price&#xA;on price.SKU_CODE =detailed.Product&#xA;join dim.DIM_SKUS as sku&#xA;on sku.SKU_CODE = detailed.Product'&#xA;)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TRUNCATE SKU_CONTRIBUTION_1"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4738DC8D-3859-49A6-96AB-54056B7F410B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TRUNCATE SKU_CONTRIBUTION_1"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="&#xA; IF OBJECT_ID('calc.SKU_CONTRIBUTION_1') IS NOT NULL&#xA;drop TABLE [calc].[SKU_CONTRIBUTION_1]&#xA;CREATE TABLE [calc].[SKU_CONTRIBUTION_1](&#xA;&#x9;[Period_Year] [float] NULL,&#xA;&#x9;[Sales Group] [int] NULL,&#xA;&#x9;[Sales office] [int] NULL,&#xA;&#x9;[Product] [bigint] NULL,&#xA;&#x9;[PRICE_INCLUDE_TAX] [bigint] NULL,&#xA;&#x9;[PRICE_EXCLUDE_TAX] [float] NULL,&#xA;&#x9;[RGB | NRB] [varchar](max) NULL,&#xA;&#x9;[SKU_contribution] [float] NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TRUNCATE SKU_CONTRIBUTION_2"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{3dd18598-bcf1-4b09-8683-d151078f96f8}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TRUNCATE SKU_CONTRIBUTION_2"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="DELETE FROM calc.SKU_CONTRIBUTION_2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TRUNCATE SKU_CONTRIBUTION_3"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{a3408116-9750-4075-aebe-afc5808acb87}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TRUNCATE SKU_CONTRIBUTION_3"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{6A2BD34F-50F9-4230-9DBE-261DF23FEB7A}"
          SQLTask:SqlStatementSource="DELETE FROM calc.SKU_CONTRIBUTION_3" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{2CEDC8AF-FDBD-4EBD-BA09-C680AEA6ACDB}"
      DTS:From="Package\TRUNCATE SKU_CONTRIBUTION_1"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\INSERT INTO SKU_CONTRIBUTION_1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{DB9D7FF3-D9DA-4F22-ABF0-6655E25D87CC}"
      DTS:From="Package\TRUNCATE SKU_CONTRIBUTION_2"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\INSERT INTO SKU_CONTRIBUTION_2" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{96CD7B0E-E71F-47FD-B586-2B780572BFEE}"
      DTS:From="Package\TRUNCATE SKU_CONTRIBUTION_3"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\INSERT INTO SKU_CONTRIBUTION_3" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="258.666666666667,41.3333333333334"
          Id="Package\INSERT INTO SKU_CONTRIBUTION_1"
          TopLeft="5.50000000000006,107.1" />
        <NodeLayout
          Size="258.666666666667,41.3333333333334"
          Id="Package\INSERT INTO SKU_CONTRIBUTION_2"
          TopLeft="324.5,107.1" />
        <NodeLayout
          Size="258.666666666667,41.3333333333334"
          Id="Package\INSERT INTO SKU_CONTRIBUTION_3"
          TopLeft="643.5,107.1" />
        <NodeLayout
          Size="261.333333333334,42.6666666666667"
          Id="Package\TRUNCATE SKU_CONTRIBUTION_1"
          TopLeft="11.5,5.50000000000007" />
        <NodeLayout
          Size="246.666666666667,41.3333333333334"
          Id="Package\TRUNCATE SKU_CONTRIBUTION_2"
          TopLeft="330.5,5.49999999999995" />
        <NodeLayout
          Size="246.666666666667,41.3333333333334"
          Id="Package\TRUNCATE SKU_CONTRIBUTION_3"
          TopLeft="649.5,5.49999999999995" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="138.5,48.1666666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58.9333333333333"
              Start="0,0"
              End="0,51.4333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,51.4333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="453.7,47.1">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.0000000000001"
              Start="0,0"
              End="0,52.5000000000001">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5000000000001" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="772.7,47.1">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.0000000000001"
              Start="0,0"
              End="0,52.5000000000001">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5000000000001" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>